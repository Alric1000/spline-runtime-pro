<!-- SOLUTION: Use Spline's Official Viewer for Perfect Quality -->
<!-- Replace your current Spline implementation with this -->

<style>
  /* Spline viewer styling */
  spline-viewer {
    width: 100%;
    height: 100%;
    display: block;
  }

  .type-trigger spline-viewer {
    pointer-events: auto;
  }

  /* Disable selection on Spline viewers */
  spline-viewer {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    -webkit-touch-callout: none;
  }
</style>

<!-- Load Spline Viewer (add to page head) -->
<script type="module" src="https://unpkg.com/@splinetool/viewer@1.10.57/build/spline-viewer.js"></script>

<!-- Smart Loading Script for Spline Viewers -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    // Configuration
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    const maxActiveScenes = isMobile ? 2 : 4;
    let activeScenes = new Set();

    // Scene URLs mapping (update these with your actual Spline URLs)
    const sceneUrls = {
        'allmountain-showcase': 'https://prod.spline.design/YOUR_ALLMOUNTAIN_ID/scene.splinecode',
        'park-showcase': 'https://prod.spline.design/YOUR_PARK_ID/scene.splinecode',
        'carve-showcase': 'https://prod.spline.design/YOUR_CARVE_ID/scene.splinecode',
        'powder-showcase': 'https://prod.spline.design/YOUR_POWDER_ID/scene.splinecode'
    };

    // Convert existing canvases to spline-viewer elements
    function convertToSplineViewer(canvasId, sceneUrl) {
        const canvas = document.getElementById(canvasId);
        if (!canvas) return;

        const parent = canvas.parentElement;

        // Create spline-viewer element
        const viewer = document.createElement('spline-viewer');
        viewer.setAttribute('url', sceneUrl);
        viewer.setAttribute('id', canvasId + '-viewer');

        // Replace canvas with viewer
        parent.replaceChild(viewer, canvas);

        console.log(`✅ Converted ${canvasId} to Spline viewer`);
        return viewer;
    }

    // Setup lazy loading with Intersection Observer
    function setupLazyLoading(viewerId) {
        const viewer = document.getElementById(viewerId);
        if (!viewer) return;

        let loaded = false;

        const observer = new IntersectionObserver((entries) => {
            if (entries[0].isIntersecting && !loaded) {
                // Check if we can load more scenes
                if (activeScenes.size >= maxActiveScenes) {
                    console.log(`⚠️ Max scenes (${maxActiveScenes}) reached, skipping ${viewerId}`);
                    return;
                }

                // Load the scene
                loaded = true;
                activeScenes.add(viewerId);
                viewer.style.visibility = 'visible';
                console.log(`▶️ Loading ${viewerId} (${activeScenes.size}/${maxActiveScenes})`);

            } else if (!entries[0].isIntersecting && loaded) {
                // Optional: pause/hide when out of view
                // viewer.style.visibility = 'hidden';
            }
        }, {
            rootMargin: '100px',
            threshold: 0.1
        });

        observer.observe(viewer);
    }

    // Initialize all scenes
    Object.entries(sceneUrls).forEach(([canvasId, sceneUrl]) => {
        const viewer = convertToSplineViewer(canvasId, sceneUrl);
        if (viewer) {
            setupLazyLoading(viewer.id);
        }
    });

    console.log(`🎯 Spline Viewer initialized for ${Object.keys(sceneUrls).length} scenes`);
    console.log(`📱 Device: ${isMobile ? 'Mobile' : 'Desktop'}, Max scenes: ${maxActiveScenes}`);
});
</script>

<!-- Alternative: Direct Implementation -->
<!-- If you want to manually add viewers to your HTML instead of converting: -->

<!-- Example for each ski type -->
<div class="type-trigger" data-type="All Mountain">
    <spline-viewer
        id="allmountain-viewer"
        url="https://prod.spline.design/YOUR_ALLMOUNTAIN_ID/scene.splinecode">
    </spline-viewer>
</div>

<div class="type-trigger" data-type="Park">
    <spline-viewer
        id="park-viewer"
        url="https://prod.spline.design/YOUR_PARK_ID/scene.splinecode">
    </spline-viewer>
</div>

<!-- etc... -->