<!-- ============================================
     FIXED WEBFLOW IMPLEMENTATION
     ============================================ -->

<!-- ============================================
     1. GLOBAL HEAD CODE (keep as is)
     ============================================ -->
<!--Smootify-->
<script>
window.SmootifyUserOptions = {
  "productsBase": "product",
  "collectionsBase": "collection",
  "vendorsBase": "account",
  "orderPageUrl": "/account/order",
  "selectMarketBasedOnBrowserLanguage": true
}
</script>

<link href="https://cdn.smootify.io/assets/latest/css/index.css" rel="stylesheet" />
<script type="module" src="https://cdn.smootify.io/assets/latest/js/index.js" async defer></script>
<script src="https://cdn.smootify.io/assets/utils/analytics.js" type="fs-cc" fs-cc-categories="analytics"></script>

<!--Spline-->
<style>
/* Global Spline viewer styles */
spline-viewer {
  width: 100%;
  height: 100%;
  display: block;
}

.type-trigger spline-viewer,
.ski_container spline-viewer,
.spinesss spline-viewer {
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
  pointer-events: auto;
}
</style>

<!-- Load Spline Viewer ONLY ONCE -->
<script type="module" src="https://spline-runtime-pro.pages.dev/spline-viewer.js"></script>

<!--Gorgias Chat Widget Start-->
<script id="gorgias-chat-widget-install-v3"
    src="https://config.gorgias.chat/bundle-loader/01J1D8FNH1D08VPMKG5Y6HXPT2">
</script>
<!--Gorgias Chat Widget End-->

<!-- Finsweet Attributes -->
<script async type="module"
src="https://cdn.jsdelivr.net/npm/@finsweet/attributes@2/attributes.js"
fs-scrolldisable
></script>


<!-- ============================================
     2. GLOBAL FOOTER CODE (SIMPLIFIED - NO HIDING)
     ============================================ -->
<script async src="https://cdn.jsdelivr.net/npm/@finsweet/cookie-consent@1/fs-cc.js" fs-cc-mode="opt-in"></script>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const CLOUDFLARE_URL = 'https://spline-runtime-pro.pages.dev';

    // Wait for spline-viewer custom element to be defined
    function waitForViewer() {
        return new Promise((resolve) => {
            if (customElements.get('spline-viewer')) {
                resolve();
            } else {
                const check = setInterval(() => {
                    if (customElements.get('spline-viewer')) {
                        clearInterval(check);
                        resolve();
                    }
                }, 100);
            }
        });
    }

    // Convert canvas to spline-viewer
    async function initializeSplineViewers() {
        await waitForViewer();

        const canvases = document.querySelectorAll('canvas[data-spline-scene]');
        console.log(`Found ${canvases.length} Spline scenes to initialize`);

        canvases.forEach(canvas => {
            const scenePath = canvas.getAttribute('data-spline-scene');
            if (!scenePath) return;

            // Create spline-viewer element
            const viewer = document.createElement('spline-viewer');
            viewer.setAttribute('url', `${CLOUDFLARE_URL}/scenes/${scenePath}/scene.splinecode`);
            viewer.setAttribute('id', canvas.id);
            viewer.className = canvas.className;

            // Copy all data attributes
            Array.from(canvas.attributes).forEach(attr => {
                if (attr.name.startsWith('data-')) {
                    viewer.setAttribute(attr.name, attr.value);
                }
            });

            // Replace canvas with viewer
            canvas.replaceWith(viewer);
        });

        console.log(`âœ… Initialized ${canvases.length} Spline viewers`);
    }

    // Initialize
    initializeSplineViewers();
});
</script>


<!-- ============================================
     3. PAGE CODE (ONLY HOVER EFFECTS)
     ============================================ -->
<style>
  /* Disable text selection for Spline scenes */
  .type-trigger, .type-trigger *,
  .ski_container, .ski_container *,
  .spinesss, .spinesss *,
  #allmountain-showcase,
  #park-showcase,
  #carve-showcase,
  #powder-showcase {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    -webkit-touch-callout: none;
    -webkit-tap-highlight-color: transparent;
  }

  /* Mobile-specific fixes */
  @media (max-width: 768px) {
    .type-trigger, .ski_container, .spinesss {
      -webkit-touch-callout: none !important;
      -webkit-user-select: none !important;
      user-select: none !important;
    }
  }
</style>

<!-- Hover text script ONLY -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const span = document.getElementById('typeSpan');
    if (!span) return;

    const defaultText = span.textContent;
    const triggers = document.querySelectorAll('.type-trigger');

    triggers.forEach(el => {
        const value = el.getAttribute('data-type');
        el.addEventListener('mouseenter', () => {
            if (value) span.textContent = value;
        });
        el.addEventListener('mouseleave', () => {
            span.textContent = defaultText;
        });
    });
});
</script>


<!-- ============================================
     4. EMBED CODE (stays the same)
     ============================================ -->
<!-- Carve Ski -->
<canvas
    id="carve-showcase"
    data-spline-scene="1000SKSCARVE">
</canvas>